<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="yzhe819"><title>MIT 6.S081 Lab 0 搭建环境 ｜ yzhe819</title><meta name=description content=" 本篇文章主要记录MIT 6.S081实验环境的搭建和版本管理的配置。
官网链接：Lab: Tools
本地环境为：Windows 10 + WSL2 (Ubuntu 20.04.4 LTS)
"><meta name=keywords content="yzhe819,zozo"><link rel="shortcut icon" href=https://yzhe819.github.io/images/favicon.ico><link rel=stylesheet type=text/css media=screen href=https://yzhe819.github.io/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css><link rel=stylesheet type=text/css media=screen href=https://yzhe819.github.io/css/zozo.css><link rel=stylesheet type=text/css media=screen href=https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css><link rel=stylesheet type=text/css media=screen href=https://yzhe819.github.io/css/highlight.css></head><body><div class="main animate__animated animate__fadeInDown"><div class="nav_container animated fadeInDown"><div class=site_nav id=site_nav><ul><li><a href=/>Home</a></li><li><a href=/posts/>Archive</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li></ul></div><div class=menu_icon><a id=menu_icon><i class=ri-menu-line></i></a></div></div><div class="header animated fadeInDown"><div class=site_title_container><div class=site_title><h1><a href=https://yzhe819.github.io/><span>yzhe819</span></a></h1></div><div class=description><p class=sub_title>yzhe819's Blog</p><div class=my_socials><a href=https://github.com/yzhe819 title=github target=_blank><i class=ri-github-fill></i></a>
<a href=https://yzhe819.github.io/index.xml type=application/rss+xml title=rss target=_blank><i class=ri-rss-fill></i></a></div></div></div></div><div class=content><div class=post_page><div class="post animate__animated animate__fadeInDown"><div class="post_title post_detail_title"><h2><a href=/posts/mit-6.s081.lab-0/>MIT 6.S081 Lab 0 搭建环境</a></h2><span class=date>2022.06.07</span></div><div class="post_content markdown"><blockquote><p>本篇文章主要记录MIT 6.S081实验环境的搭建和版本管理的配置。</p></blockquote><p>官网链接：<a href=https://pdos.csail.mit.edu/6.828/2020/tools.html>Lab: Tools</a></p><p>本地环境为：Windows 10 + WSL2 (Ubuntu 20.04.4 LTS)</p><h2 id=环境搭建>环境搭建</h2><h3 id=官方搭建指导>官方搭建指导</h3><p><a href=https://pdos.csail.mit.edu/6.828/2020/tools.html>官方的搭建步骤</a></p><p><img src=/tools.png alt=官方的搭建步骤></p><h3 id=本地搭建记录>本地搭建记录</h3><p>首先进入WSL2：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ bash
</span></span></code></pre></div><p>然后检查 ubuntu 版本，确保 ubuntu 是在20或者以上。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ lsb_release -a
</span></span></code></pre></div><p><strong>特别注意</strong>：这里检查版本是因为只有 ubuntu 20.04 下面才有对应的某个package的镜像源，如果是版本18是无法查找到的。<strong>如果有需要请自行更新WSL</strong></p><p>然后根据官方教程，把一系列依赖装上：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get install git build-essential gdb-multiarch qemu-system-misc gcc-riscv64-linux-gnu binutils-riscv64-linux-gnu
</span></span></code></pre></div><p>接下来就是qemu-system-misc 修复，qemu-system-misc 包收到了一个更新，该更新破坏了它与内核的兼容性， 所以需要一个老版本。</p><p>先卸载新版本：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get remove qemu-system-misc
</span></span></code></pre></div><p>然后安装老的兼容版本：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get install qemu-system-misc<span class=o>=</span>1:4.2-3ubuntu6
</span></span></code></pre></div><p><strong>特别注意</strong>：这个<strong>qemu-system-misc=1:4.2-3ubuntu6</strong>就是前文提到 <strong>ubuntu 18</strong> 所找不到的包</p><p>这里需要补一个包，运行以下命令，会得到not found信息：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ riscv64-unknown-elf-gcc --version
</span></span></code></pre></div><p>可以直接装。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt install gcc-riscv64-unknown-elf-gcc
</span></span></code></pre></div><p>再次测试，现在应该可以正确显示版本：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ riscv64-unknown-elf-gcc --version
</span></span><span class=line><span class=cl>riscv64-unknown-elf-gcc <span class=o>(</span>GCC<span class=o>)</span> 10.1.0
</span></span></code></pre></div><p>检查环境是否搭建完成。</p><p>运行这两个版本检查，输出版本信息一样就完成了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ qemu-system-riscv64 --version
</span></span><span class=line><span class=cl>QEMU emulator version 5.1.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ riscv64-unknown-elf-gcc --version
</span></span><span class=line><span class=cl>riscv64-unknown-elf-gcc (GCC) 10.1.0
</span></span></code></pre></div><h2 id=版本控制>版本控制</h2><p>我们需要将课程代码下载到本地以及使用github来进行开发管理:</p><p>首先在Github上新开一个空仓库。</p><p>然后将mit的实验代码克隆到本地：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git clone git://g.csail.mit.edu/xv6-labs-2020
</span></span></code></pre></div><p>进入对于文件夹以及切换分支：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>cd</span> xv6-labs-2020
</span></span><span class=line><span class=cl>$ git checkout util
</span></span></code></pre></div><p><strong>注</strong>：MIT 6.S081 这门课程每个lab对应一个git分支，util分支是第一个lab的分支，这里用这个分支测试之前搭建</p><p>执行命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo make qemu
</span></span></code></pre></div><p>看到下列输出证明我们的配置生效了：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>xv6 kernel is booting
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>hart 2 starting
</span></span><span class=line><span class=cl>hart 1 starting
</span></span><span class=line><span class=cl>init: starting sh
</span></span></code></pre></div><p>在这种情况下输入ls会得到以下输出：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ls
</span></span><span class=line><span class=cl>.              1 1 1024
</span></span><span class=line><span class=cl>..             1 1 1024
</span></span><span class=line><span class=cl>README         2 2 2104
</span></span><span class=line><span class=cl>xargstest.sh   2 3 99
</span></span><span class=line><span class=cl>cat            2 4 23864
</span></span><span class=line><span class=cl>echo           2 5 22688
</span></span><span class=line><span class=cl>forktest       2 6 13000
</span></span><span class=line><span class=cl>grep           2 7 27208
</span></span><span class=line><span class=cl>init           2 8 23776
</span></span><span class=line><span class=cl>kill           2 9 22664
</span></span><span class=line><span class=cl>ln             2 10 22608
</span></span><span class=line><span class=cl>ls             2 11 26104
</span></span><span class=line><span class=cl>mkdir          2 12 22760
</span></span><span class=line><span class=cl>rm             2 13 22744
</span></span><span class=line><span class=cl>sh             2 14 41736
</span></span><span class=line><span class=cl>stressfs       2 15 23760
</span></span><span class=line><span class=cl>usertests      2 16 147440
</span></span><span class=line><span class=cl>grind          2 17 37872
</span></span><span class=line><span class=cl>wc             2 18 24968
</span></span><span class=line><span class=cl>zombie         2 19 22136
</span></span><span class=line><span class=cl>console        3 20 0
</span></span></code></pre></div><p><strong>注</strong>：偏题了，回归版本管理</p><p>添加git仓库的地址，这个仓库地址是第一步新建的仓库地址</p><p><del>就是平时使用git clone后的链接</del></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git remote add github 你的仓库地址
</span></span></code></pre></div><p><strong>特别注意</strong>：请勿随意修改.git目录和原origin指向的链接</p><p>接着我们可以把lab1的实验代码推送到github：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git push github util:util
</span></span></code></pre></div><p><strong>注</strong>：命令中的github是远程主机名，表示会推到上一步推到的链接上</p><p><strong>注</strong>：版本控制的部分<a href=http://xv6.dgs.zone/>6.S081-All-In-One-Gitbook</a>提供了图文教程，可以进行参考</p><p>好了到这里，我们已经配置到基础的环境和做好了版本管理</p><p>接下来就能开始做lab实验了🎉</p><p>Happy coding 💖</p></div><div class=post_footer><div class=meta><div class=info><span class="field tags"><i class=ri-stack-line></i>
<a href=https://yzhe819.github.io/tags/%E4%B8%AD%E6%96%87/>中文</a>
<a href=https://yzhe819.github.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/>操作系统</a>
<a href=https://yzhe819.github.io/tags/6.s081/>6.S081</a></span></div></div></div></div><div class=doc_comments></div></div></div></div><a id=back_to_top href=# class=back_to_top><i class=ri-arrow-up-s-line></i></a><footer class=footer><div class=powered_by><a href=https://varkai.com>Designed by VarKai,</a>
<a href=http://www.gohugo.io/>Proudly published with Hugo</a></div><div class=footer_slogan><span></span></div></footer><script src=https://yzhe819.github.io/js/jquery-3.5.1.min.js></script>
<link href=https://yzhe819.github.io/css/fancybox.min.css rel=stylesheet><script src=https://yzhe819.github.io/js/fancybox.min.js></script>
<script src=https://yzhe819.github.io/js/zozo.js></script>
<script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style></body></html>