<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="yzhe819"><title>Mit 6.S081 实验室指导 ｜ yzhe819</title><meta name=description content=" 本篇文章是原始Lab guidance的机器翻译
介绍作业难度的划分以及一些调试建议
原文链接为：Lab guidance
"><meta name=keywords content="yzhe819,zozo"><link rel="shortcut icon" href=https://yzhe819.github.io/images/favicon.ico><link rel=stylesheet type=text/css media=screen href=https://yzhe819.github.io/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css><link rel=stylesheet type=text/css media=screen href=https://yzhe819.github.io/css/zozo.css><link rel=stylesheet type=text/css media=screen href=https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css><link rel=stylesheet type=text/css media=screen href=https://yzhe819.github.io/css/highlight.css></head><body><div class="main animate__animated animate__fadeInDown"><div class="nav_container animated fadeInDown"><div class=site_nav id=site_nav><ul><li><a href=/>Home</a></li><li><a href=/posts/>Archive</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li></ul></div><div class=menu_icon><a id=menu_icon><i class=ri-menu-line></i></a></div></div><div class="header animated fadeInDown"><div class=site_title_container><div class=site_title><h1><a href=https://yzhe819.github.io/><span>yzhe819</span></a></h1></div><div class=description><p class=sub_title>yzhe819's Blog</p><div class=my_socials><a href=https://github.com/yzhe819 title=github target=_blank><i class=ri-github-fill></i></a>
<a href=https://yzhe819.github.io/index.xml type=application/rss+xml title=rss target=_blank><i class=ri-rss-fill></i></a></div></div></div></div><div class=content><div class=post_page><div class="post animate__animated animate__fadeInDown"><div class="post_title post_detail_title"><h2><a href=/posts/mit-6.s081-lab-guidance/>Mit 6.S081 实验室指导</a></h2><span class=date>2022.06.07</span></div><div class="post_content markdown"><blockquote><p>本篇文章是原始Lab guidance的机器翻译</p></blockquote><p>介绍作业难度的划分以及一些调试建议</p><p>原文链接为：<a href=https://pdos.csail.mit.edu/6.828/2020/labs/guidance.html>Lab guidance</a></p><h2 id=作业的难度>作业的难度</h2><p>每个作业都表明它的难度：</p><ul><li>容易：不到一个小时。这些练习通常是后续练习的热身练习。</li><li>中度：1-2 小时。</li><li>硬：超过 2 小时。通常，这些练习不需要太多代码，但要正确编写代码却很棘手。</li></ul><p>这些时间是我们预期的粗略估计。对于一些可选任务，我们没有解决方案，难度是一个疯狂的猜测。</p><p>练习一般不需要太多的代码行（几十到几百行），但代码在概念上很复杂，而且通常细节很重要。因此，在编写任何代码之前，请确保为实验室完成了指定的阅读，通读相关文件，查阅文档（RISC-V 手册等在<a href=https://pdos.csail.mit.edu/6.828/2020/reference.html>参考页面上）。</a>只有当你牢牢掌握了任务和解决方案后，才开始编码。当您开始编码时，分小步实施您的解决方案（作业通常会建议如何以较小的步骤分解问题）并测试每个步骤是否有效，然后再进行下一个步骤。</p><p>警告：不要在实验室到期的前一天晚上开始实验室；在多天的多个会话中进行实验室的时间效率更高。操作系统内核中的错误表现可能令人困惑，可能需要经过深思熟虑和仔细调试才能理解和修复。</p><h2 id=调试提示>调试提示</h2><p>以下是调试解决方案的一些提示：</p><ul><li><p>确保您了解 C 和指针。Kernighan 和 Ritchie 所著的《C 编程语言（第二版）》一书对 C 进行了简洁的描述。 <a href=https://pdos.csail.mit.edu/6.828/2019/lec/pointers.c>这里</a>提供了一些有用的指针练习。除非您已经完全精通 C，否则不要跳过或略读上面的指针练习。如果你没有真正理解 C 语言中的指针，你将在实验室中遭受数不清的痛苦和苦难，然后最终以艰难的方式理解它们。相信我们; 你不想知道什么是“困难的方式”。</p><p>一些指针常用习语特别值得记住：</p><ul><li>如果<code>int *p = (int*)100</code>, 那么 <code>(int)p + 1</code>和<code>(int)(p + 1)</code> 是不同的数字：第一个是<code>101</code>但第二个是<code>104</code>。将整数添加到指针时，如第二种情况，整数隐式乘以指针指向的对象的大小。</li><li><code>p[i]</code>被定义为与 相同<code>*(p+i)</code>，指的是 p 所指向的内存中的第 i 个对象。当对象大于一个字节时，上述添加规则有助于此定义工作。</li><li><code>&p[i]</code>与 相同<code>(p+i)</code>，产生 p 指向的内存中第 i 个对象的地址。</li></ul><p>尽管大多数 C 程序从不需要在指针和整数之间进行转换，但操作系统经常这样做。每当您看到涉及内存地址的加法时，请询问自己是整数加法还是指针加法，并确保所添加的值被适当地相乘。</p></li><li><p>如果您的练习部分有效，请通过提交代码来检查您的进度。如果你稍后破坏了某些东西，你可以回滚到你的检查点并以更小的步骤前进。要了解有关 Git 的更多信息，请查看 <a href=http://www.kernel.org/pub/software/scm/git/docs/user-manual.html>Git 用户手册</a>，或者，您可能会发现这个 <a href=http://eagain.net/articles/git-for-computer-scientists/>面向 CS 的 Git 概述</a>很有用。</p></li><li><p>如果您未通过测试，请确保您了解您的代码未通过测试的原因。插入打印语句，直到您了解发生了什么。</p></li><li><p>您可能会发现您的打印语句可能会产生很多您想搜索的输出；一种方法是 在<code>脚本</code>内运行<code>make qemu</code>（在您的机器上运行），它将所有控制台输出记录到一个文件中，然后您可以搜索该文件。不要忘记退出<code>脚本</code>。 <code>man script</code></p></li><li><p>在许多情况下，打印语句就足够了，但有时能够单步执行某些汇编代码或检查堆栈上的变量会很有帮助。要将 gdb 与 xv6 一起使用，请在一个窗口中运行 make make qemu-gdb，在另一个窗口中运行gdb（或riscv64-linux-gnu-gdb），设置断点，然后按 &lsquo;c&rsquo;（继续），xv6 将一直运行，直到遇到断点。（有关有用的 GDB 提示， 请参阅<a href=https://pdos.csail.mit.edu/6.828/2019/lec/gdb_slides.pdf>使用 GNU 调试器。）</a></p></li><li><p>如果您想查看编译器为内核生成的程序集是什么，或者要找出特定内核地址处的指令是什么，请查看文件<code>kernel.asm</code>，该文件是 Makefile 在编译内核时生成的。（Makefile 还为所有用户程序 生成<code>.asm 。）</code></p></li><li><p>如果内核崩溃，它将打印一条错误消息，列出程序计数器崩溃时的值；您可以搜索<code>kernel.asm</code>以找出程序计数器崩溃时在哪个函数中，或者您可以运行（运行 以获取详细信息）。如果要获取回溯，请使用 gdb 重新启动：在一个窗口中运行 &lsquo;make qemu-gdb&rsquo;，在另一个窗口中运行 gdb（或 riscv64-linux-gnu-gdb），在 panic (&lsquo;b panic&rsquo;) 中设置断点，然后后跟“c”（继续）。当内核到达断点时，键入“bt”以获取回溯。 addr2line -e kernel/kernel <em>pc-value</em>man addr2line</p></li><li><p>如果您的内核挂起（例如，由于死锁）或无法继续执行（例如，由于执行内核指令时出现页面错误），您可以使用 gdb 找出它挂起的位置。在一个窗口中运行“make qemu-gdb”，在另一个窗口中运行 gdb (riscv64-linux-gnu-gdb)，然后是“c”（继续）。当内核出现挂起时，在 qemu-gdb 窗口中按 Ctrl-C 并键入“bt”以获取回溯。</p></li><li><p><code>qemu</code>有一个“监视器”，可以让您查询模拟机器的状态。您可以通过键入 control-a c 来获得它（“c”用于控制台）。一个特别有用的监控命令是<code>info mem</code>来打印页表。您可能需要使用<code>cpu</code>命令来选择要查看的核心<code>信息 mem</code>，或者您可以使用<code>make CPUS=1 qemu</code>启动 qemu以导致只有一个核心。</p></li></ul><p>学习上述工具非常值得。</p></div><div class=post_footer><div class=meta><div class=info><span class="field tags"><i class=ri-stack-line></i>
<a href=https://yzhe819.github.io/tags/%E4%B8%AD%E6%96%87/>中文</a>
<a href=https://yzhe819.github.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/>操作系统</a>
<a href=https://yzhe819.github.io/tags/6.s081/>6.S081</a></span></div></div></div></div><div class=doc_comments></div></div></div></div><a id=back_to_top href=# class=back_to_top><i class=ri-arrow-up-s-line></i></a><footer class=footer><div class=powered_by><a href=https://varkai.com>Designed by VarKai,</a>
<a href=http://www.gohugo.io/>Proudly published with Hugo</a></div><div class=footer_slogan><span></span></div></footer><script src=https://yzhe819.github.io/js/jquery-3.5.1.min.js></script>
<link href=https://yzhe819.github.io/css/fancybox.min.css rel=stylesheet><script src=https://yzhe819.github.io/js/fancybox.min.js></script>
<script src=https://yzhe819.github.io/js/zozo.js></script>
<script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style></body></html>